/*E-COMMERCE*/

---------------------------------CRIANDO O SCHEMA------------------------------------------
CREATE DATABASE ECOMMERCE;

USE ECOMMERCE;

CREATE TABLE CLIENTE(
	IDCLIENTE INT AUTO_INCREMENT,
	PNOME VARCHAR(20) NOT NULL,
	SNOME VARCHAR(45) NOT NULL,
	CPF CHAR(11) NOT NULL UNIQUE,
	CONTATO CHAR(12) NOT NULL,
	TIPO_DE_CONTATO ENUM('CEL','COM','FIXO') NOT NULL,
	EMAIL VARCHAR(45) NOT NULL,
	DATA_NASCIMENTO DATE NOT NULL,
	SEXO ENUM('M','F','O') NOT NULL,
	CONSTRAINT PK_CLIENTE PRIMARY KEY (IDCLIENTE)
);

CREATE TABLE ENDEREÇO(
	IDENDEREÇO INT AUTO_INCREMENT,
	RUA VARCHAR(45),
	BAIRRO VARCHAR(45),
	NUMERO VARCHAR(10) NOT NULL,
	CIDADE VARCHAR(45),
	CEP CHAR(8) NOT NULL,
	ESTADO CHAR(2),
	PAÍS VARCHAR(45),
	IDCLIENTE INT,
	CONSTRAINT PK_ENDEREÇO PRIMARY KEY (IDENDEREÇO)
);

CREATE TABLE VENDEDOR(
	IDVENDEDOR INT AUTO_INCREMENT,
	NOME VARCHAR(45) NOT NULL,
	ENDEREÇO VARCHAR(100) NOT NULL,
	IDENTIFICAÇÃO VARCHAR(16) NOT NULL UNIQUE,
	CONSTRAINT PK_VENDEDOR PRIMARY KEY (IDVENDEDOR)
);

CREATE TABLE PEDIDO(
	IDPEDIDO INT AUTO_INCREMENT,
	TEMPO_DEVOLUÇÃO VARCHAR(50) NOT NULL,
	STATUS ENUM('EM ANDAMENTO','CONCLUIDO','PAGO','CANCELADO') NOT NULL,
	IDCLIENTE INT,
	IDVENDEDOR INT,
	IDFORMADEPAGAMENTO INT,
	CONSTRAINT PK_IDPEDIDO PRIMARY KEY (IDPEDIDO)
);

CREATE TABLE FORMA_DE_PAGAMENTO(
	IDFORMADEPAGAMENTO INT AUTO_INCREMENT,
	CONSTRAINT PK_FORMADEPAGAMENTO PRIMARY KEY (IDFORMADEPAGAMENTO)
);

CREATE TABLE PIX(
	IDENTIFICADOR VARCHAR(50) NOT NULL,
	IDFORMADEPAGAMENTO INT UNIQUE
);

CREATE TABLE CARTÃO(
	NUMERO VARCHAR(16) NOT NULL,
	DATADEVALIDADE VARCHAR(5) NOT NULL,
	CÓDIGO CHAR(3) NOT NULL,
	IDFORMADEPAGAMENTO INT UNIQUE
);

CREATE TABLE ENTREGA(
	IDENTREGA INT AUTO_INCREMENT,
	STATUS ENUM('PREPARANDO','A CAMINHO','ENTREGUE') NOT NULL,
	VALORFRETE DECIMAL(10,2) NOT NULL,
	IDPEDIDO INT,
	CONSTRAINT PK_ENTREGA PRIMARY KEY (IDENTREGA)
);

CREATE TABLE CONTEM(
	IDCONTEM INT AUTO_INCREMENT,
	QUANTIDADEDEPRODUTO INT NOT NULL,
	STATUS ENUM('DISPONÍVEL','INDISPONÍVEL'),
	IDPEDIDO INT,
	IDPRODUTO INT,
	AVALIAÇÃO FLOAT,
	CONSTRAINT PK_CONTEM PRIMARY KEY (IDCONTEM)
);

CREATE TABLE PRODUTO(
	IDPRODUTO INT AUTO_INCREMENT,
	VALORDEVENDA DECIMAL(10,2) NOT NULL,
	CATEGORIA VARCHAR(45) NOT NULL,
	NOME VARCHAR(45) NOT NULL,
	CONSTRAINT PK_PRODUTO PRIMARY KEY (IDPRODUTO)
);

CREATE TABLE FORNECIMENTO(
	IDFORNECIMENTO INT AUTO_INCREMENT,
	QUANTIDADEADQUIRIDA INT NOT NULL,
	DATA DATE NOT NULL,
	VALORDECOMPRA DECIMAL(10,2) NOT NULL,
	IDPRODUTO INT,
	IDFORNECEDOR INT,
	CONSTRAINT PK_FORNECIMENTO PRIMARY KEY (IDFORNECIMENTO)
);

CREATE TABLE FORNECEDOR(
	IDFORNECEDOR INT AUTO_INCREMENT,
	RAZÃOSOCIAL VARCHAR(50) NOT NULL,
	CNPJ VARCHAR(50) NOT NULL UNIQUE,
	ENDEREÇO VARCHAR(150) NOT NULL,
	CONTATO VARCHAR(11) NOT NULL,
	CONSTRAINT PK_FORNECEDOR PRIMARY KEY (IDFORNECEDOR)
);


CREATE TABLE ARMAZENA(
	IDARMAZENA INT AUTO_INCREMENT,
	IDESTOQUE INT,
	IDPRODUTO INT,
	QUANTIDADE INT,
	CONSTRAINT PK_ARMAZENA PRIMARY KEY (IDARMAZENA)
);

CREATE TABLE ESTOQUE(
	IDESTOQUE INT AUTO_INCREMENT,
	RUA VARCHAR(45),
	BAIRRO VARCHAR(45),
	NUMERO VARCHAR(10) NOT NULL,
	CIDADE VARCHAR(45),
	CEP CHAR(8) NOT NULL,
	ESTADO CHAR(2),
	PAÍS VARCHAR(45),
	CONSTRAINT PK_ESTOQUE PRIMARY KEY (IDESTOQUE)
);

ALTER TABLE ENDEREÇO ADD CONSTRAINT FK_ENDEREÇO_CLIENTE
FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE(IDCLIENTE);

ALTER TABLE PIX ADD CONSTRAINT FK_PIX_FORMADEPAGAMENTO
FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMA_DE_PAGAMENTO(IDFORMADEPAGAMENTO);

ALTER TABLE CARTÃO ADD CONSTRAINT FK_CARTÃO_FORMADEPAGAMENTO
FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMA_DE_PAGAMENTO(IDFORMADEPAGAMENTO);

ALTER TABLE PEDIDO ADD CONSTRAINT FK_PEDIDO_CLIENTE
FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE(IDCLIENTE);

ALTER TABLE PEDIDO ADD CONSTRAINT FK_PEDIDO_VENDEDOR
FOREIGN KEY (IDVENDEDOR) REFERENCES VENDEDOR(IDVENDEDOR);

ALTER TABLE PEDIDO ADD CONSTRAINT FK_PEDIDO_FORMADEPAGAMENTO
FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMA_DE_PAGAMENTO(IDFORMADEPAGAMENTO);

ALTER TABLE ENTREGA ADD CONSTRAINT FK_ENTREGA_PEDIDO
FOREIGN KEY (IDPEDIDO) REFERENCES PEDIDO(IDPEDIDO);

ALTER TABLE CONTEM ADD CONSTRAINT FK_CONTEM_PEDIDO
FOREIGN KEY (IDPEDIDO) REFERENCES PEDIDO(IDPEDIDO);

ALTER TABLE CONTEM ADD CONSTRAINT FK_CONTEM_PRODUTO
FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO(IDPRODUTO);

ALTER TABLE ARMAZENA ADD CONSTRAINT FK_ARMAZENA_PRODUTO
FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO(IDPRODUTO);

ALTER TABLE ARMAZENA ADD CONSTRAINT FK_ARMAZENA_ESTOQUE
FOREIGN KEY (IDESTOQUE) REFERENCES ESTOQUE(IDESTOQUE);

ALTER TABLE FORNECIMENTO ADD CONSTRAINT FK_FORNECIMENTO_PRODUTO
FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO(IDPRODUTO);

ALTER TABLE FORNECIMENTO ADD CONSTRAINT FK_FORNECIMENTO_FORNECEDOR
FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR(IDFORNECEDOR); 
---------------------------------ADICIONANDO VALORES----------------------------------

INSERT INTO CLIENTE VALUES 
(NULL, 'LAURA','PINHEIRO','12365478954','37996581234','CEL','LAURA@GMAIL.COM','1996/10/26','F'),   
(NULL, 'JOSE','MARAES','89654478954','37996585698','COM','JM@GMAIL.COM','1985/11/06','M'),
(NULL, 'MARIA','DO CARMO','89654128954','37975411234','CEL','MDC@GMAIL.COM','2000/01/15','F'),
(NULL, 'ROSE','MACHADO','87456328954','37994563217','CEL','RM@GMAIL.COM','1992/09/26','F'),
(NULL, 'FABIO','RODRIGUES','89621478954','37997456321','FIXO','FR@GMAIL.COM','1990/05/08','M'),
(NULL, 'JORGE','ARAGÃO','12856478954','37996123654','CEL','JA@GMAIL.COM','2005/12/26','M'),
(NULL, 'ANA','CAROLINA','45625478954','37996275634','CEL','AC@GMAIL.COM','1987/05/09','F'),
(NULL, 'NATHALIA','FERREIRA','12386547954','37996575632','COM','NF@GMAIL.COM','1970/04/17','F');


INSERT INTO ENDEREÇO VALUES
(NULL,'RUA DOS PASSOS','CENTRO','52','VIÇOSA','35621478','MG','BRASIL',1),
(NULL,'RUA DOS PASSAROS','LOANDA','287','JOÃO MONLEVADE','38624478','MG','BRASIL',2),
(NULL,'RUA JOSE ALGUSTO','CENTRO','78','RIO DE JANEIRO','56321478','RJ','BRASIL',3),
(NULL,'RUA GUSTAVO DE MELO','JARDIM DAS ROSAS','632','ALEGRE','35845678','ES','BRASIL',4),
(NULL,'RUA 5','CENTRO','152','ALEGRE','35321478','ES','BRASIL',5),
(NULL,'RUA 10','CENTRO','865','VIÇOSA','35854778','MG','BRASIL',6),
(NULL,'RUA DA PAZ','SÃO VICENTE','754','SÃO PAULO','35765478','SP','BRASIL',7),
(NULL,'RUA NOVA','CENTRO','652','SÃO PAULO','35629658','SP','BRASIL',8);

INSERT INTO VENDEDOR VALUES
(NULL,'TUDOBARATO','RUA 2,BAIRRO DOS REIS, 874,JOÃO MONLEVADE,MG,BRASIL','14541269875234'),
(NULL,'JOÃO ANTONIO','RUA DA SERRA,SÃO JOSE, 457,VIÇOSA,MG,BRASIL','86574231945'),
(NULL,'ALINE FAGUNDES','RUA 8,SANTO AGOSTINHO, 147,RIO DE JANEIRO,RJ,BRASIL','86574293101');

INSERT INTO FORMA_DE_PAGAMENTO VALUES
(NULL),
(NULL),
(NULL),
(NULL),
(NULL),
(NULL),
(NULL),
(NULL),
(NULL);

INSERT INTO PIX VALUES
('LAURA@GMAIL.COM',1),
('37975411234',3),
('45625478954',7),
('NF@GMAIL.COM',8),
('89654478954',2),
('37994563217',4);

INSERT INTO CARTÃO VALUES
('4562135487495623','01/28','468',9),
('6325741285690152','05/27','054',5),
('1230745865479321','06/24','963',6);

INSERT INTO PEDIDO VALUES
(NULL,'5 DIAS','EM ANDAMENTO',1,1,1),
(NULL,'3 DIAS','PAGO',2,2,9),
(NULL,'12 DIAS','CONCLUIDO',3,1,3),
(NULL,'20 DIAS','CONCLUIDO',4,2,4),
(NULL,'5 DIAS','PAGO',5,2,5),
(NULL,'3 DIAS','PAGO',6,1,6),
(NULL,'8 DIAS','EM ANDAMENTO',7,1,7),
(NULL,'9 DIAS','EM ANDAMENTO',8,1,8),
(NULL,'10 DIAS','EM ANDAMENTO',8,1,8),
(NULL,'7 DIAS','PAGO',1,3,1),
(NULL,'7 DIAS','CONCLUIDO',1,1,1),
(NULL,'5 DIAS','PAGO',7,3,7),
(NULL,'30 DIAS','CONCLUIDO',5,2,5),
(NULL,'8 DIAS','CONCLUIDO',2,2,2),
(NULL,'10 DIAS','PAGO',2,1,2),
(NULL,'8 DIAS','PAGO',5,3,5),
(NULL,'9 DIAS','CANCELADO',1,2,1);

INSERT INTO PRODUTO VALUES
(NULL,500.50,'MOVEIS','MESA DE MARMORE'),
(NULL,200.50,'MOVEIS','CADEIRA DE MARMORE'),
(NULL,400.00,'MOVEIS','ARMARIO'),
(NULL,20.50,'DOCES','PIRULITO'),
(NULL,50.50,'DOCES','PIPOCA'),
(NULL,25.50,'BRINQUEDOS','BONECA'),
(NULL,30.50,'BRINQUEDOS','CARRO'),
(NULL,550.50,'BRINQUEDOS','BICICLETA'),
(NULL,45.50,'BRINQUEDOS','PETECA'),
(NULL,59.90,'ROUPA','CAMISA FEMININA'),
(NULL,99.50,'ROUPA','CALÇA'),
(NULL,15.00,'ROUPA','CUECA'),
(NULL,180.50,'ROUPA','JAQUETA JEANS'),
(NULL,25.50,'UTENSILIOS','COLHER DE PAU'),
(NULL,20.50,'UTENSILIOS','MEDIDOR DE VOLUME'),
(NULL,150.80,'UTENSILIOS','FAQUEIRO'),
(NULL,80.50,'UTENSILIOS','PANELA DE PRESSÃO'),
(NULL,50.50,'UTENSILIOS','FORMA DE BOLO'),
(NULL,30.50,'UTENSILIOS','PANOS DE PRATO');


INSERT INTO FORNECEDOR VALUES
(NULL,'MOVEIS BONS','58963214752385','RUA 8,BAIRRO ITALIA, 80,JOÃO MONLEVADE,MG,BRASIL','38514913'),
(NULL,'FORMIGA DOCE','58624137526897','RUA 3 DE JANEIRO,BAIRRO DOS SINOS, 874,RIO DE JANEIRO,RJ,BRASIL','998561234'),
(NULL,'SAPECA','58963217856234','RUA SALVADOR,OURO BRANCO, 109,RIO DE JANEIRO,RJ,BRASIL','31998756324'),
(NULL,'JEANS DA MODA','89654234752385','RUA FORTALEZA,BAIRRO DOS IMIGRANTES, 654,SÃO PAULO,SP,BRASIL','958745624'),
(NULL,'TUDO PARA SUA CASA','74562114752385','RUA 80,SANTO DIVINO, 63,SÃO PAULO,SP,BRASIL','98723654');

INSERT INTO FORNECIMENTO VALUES
(NULL,5,'2023/01/15',350.00,1,1),
(NULL,40,'2023/01/15',120.00,2,1),
(NULL,6,'2023/01/15',200.00,3,1),
(NULL,50,'2023/01/15',15.00,4,2),
(NULL,35,'2023/01/15',35.00,5,2),
(NULL,20,'2023/01/15',18.00,6,3),
(NULL,15,'2023/01/15',25.00,7,3),
(NULL,40,'2023/01/15',350.00,8,3),
(NULL,30,'2023/01/15',20.00,9,3),
(NULL,8,'2023/01/15',30.00,10,4),
(NULL,60,'2023/01/15',65.00,11,4),
(NULL,100,'2023/01/15',8.00,12,4),
(NULL,10,'2023/01/15',100.00,13,4),
(NULL,25,'2023/01/15',15.00,14,5),
(NULL,35,'2023/01/15',15.00,15,5),
(NULL,5,'2023/01/15',90.00,16,5),
(NULL,15,'2023/01/15',45.00,17,5),
(NULL,20,'2023/01/15',25.00,18,5),
(NULL,60,'2023/01/15',15.00,19,5);




INSERT INTO ESTOQUE VALUES
(NULL,'RUA HUMBERTO REIS','CENTRO','452','VIÇOSA','35562478','MG','BRASIL'),
(NULL,'RUA 60','CENTRO','102','RIO DE JANEIRO','35963524','RJ','BRASIL'),
(NULL,'RUA 25 DE MARÇO','CENTRO','876','SÃO PAULO','87456278','SP','BRASIL');


INSERT INTO ARMAZENA VALUES
(NULL,1,1,10),
(NULL,1,2,80),
(NULL,1,3,70),
(NULL,2,4,15),
(NULL,2,5,60),
(NULL,2,6,80),
(NULL,2,7,40),
(NULL,2,8,60),
(NULL,2,9,10),
(NULL,3,10,28),
(NULL,3,11,19),
(NULL,3,12,74),
(NULL,3,13,63),
(NULL,3,14,53),
(NULL,3,15,74),
(NULL,3,16,123),
(NULL,3,17,87),
(NULL,3,18,20),
(NULL,3,19,64);

INSERT INTO CONTEM VALUES
(NULL,1,'DISPONÍVEL',1,5,4),
(NULL,2,'DISPONÍVEL',2,9,3.5),
(NULL,4,'DISPONÍVEL',3,7,2),
(NULL,1,'DISPONÍVEL',4,16,5),
(NULL,1,'DISPONÍVEL',5,4,5),
(NULL,6,'DISPONÍVEL',6,1,5),
(NULL,1,'DISPONÍVEL',7,19,2.6),
(NULL,1,'DISPONÍVEL',8,18,4.6),
(NULL,6,'DISPONÍVEL',9,17,4.2),
(NULL,1,'DISPONÍVEL',10,16,4.8),
(NULL,3,'DISPONÍVEL',11,15,4.9),
(NULL,2,'DISPONÍVEL',12,14,4.3),
(NULL,4,'DISPONÍVEL',13,13,4),
(NULL,6,'DISPONÍVEL',14,12,1),
(NULL,1,'DISPONÍVEL',15,11,2),
(NULL,1,'DISPONÍVEL',16,10,5),
(NULL,1,'DISPONÍVEL',17,9,2.9),
(NULL,5,'DISPONÍVEL',1,8,3.9),
(NULL,7,'DISPONÍVEL',5,7,4),
(NULL,1,'DISPONÍVEL',7,6,4.4),
(NULL,3,'DISPONÍVEL',1,5,4.6),
(NULL,2,'DISPONÍVEL',12,4,4.5),
(NULL,1,'DISPONÍVEL',9,3,4.8),
(NULL,4,'DISPONÍVEL',16,2,4.2),
(NULL,1,'DISPONÍVEL',14,1,4.7);

INSERT INTO ENTREGA VALUES
(NULL,'PREPARANDO',50,18),
(NULL,'ENTREGUE',50,19),
(NULL,'ENTREGUE',50,20),
(NULL,'ENTREGUE',50,21),
(NULL,'ENTREGUE',50,22),
(NULL,'A CAMINHO',50,23),
(NULL,'ENTREGUE',50,24),
(NULL,'PREPARANDO',50,25),
(NULL,'A CAMINHO',50,26),
(NULL,'A CAMINHO',50,27),
(NULL,'PREPARANDO',50,28),
(NULL,'ENTREGUE',50,29),
(NULL,'A CAMINHO',50,30),
(NULL,'PREPARANDO',50,31),
(NULL,'A CAMINHO',50,32),
(NULL,'ENTREGUE',50,33),
(NULL,'A CAMINHO',50,34);
----------------------------------USANDO COMANDOS PARA GERAR RELATORIOS--------------------------------------

/*Quantos pedidos foram feitos por cada cliente?*/
SELECT CONCAT(C.PNOME,' ',C.SNOME) AS 'NOME DO CLIENTE',COUNT(P.IDPEDIDO) AS 'PEDIDOS FEITOS' FROM CLIENTE C
INNER JOIN PEDIDO P ON C.IDCLIENTE=P.IDCLIENTE
GROUP BY C.IDCLIENTE;

/*VALOR TOTAL DA COMPRA*/
SELECT PE.IDPEDIDO, CONCAT(CL.PNOME,' ',CL.SNOME) AS 'NOME DO CLIENTE',C.VALOR+E.VALORFRETE AS 'VALOR DA COMPRA', 
CL.CEP AS 'ENDEREÇO DE ENTREGA' FROM PEDIDO PE
INNER JOIN (SELECT C.IDPEDIDO,SUM(C.QUANTIDADEDEPRODUTO*P.VALORDEVENDA) AS VALOR FROM CONTEM C
INNER JOIN PRODUTO P ON C.IDPRODUTO=P.IDPRODUTO
GROUP BY IDPEDIDO) C ON PE.IDPEDIDO=C.IDPEDIDO
INNER JOIN ENTREGA E ON PE.IDPEDIDO=E.IDPEDIDO
INNER JOIN (SELECT C.PNOME, C.SNOME,E.CEP,C.IDCLIENTE FROM CLIENTE C
INNER JOIN ENDEREÇO E ON C.IDCLIENTE=E.IDCLIENTE) CL ON PE.IDCLIENTE=CL.IDCLIENTE
ORDER BY 1;

/*LUCRO OBTIDO POR PRODUTO*/
SELECT P.NOME,P.CATEGORIA, F.RAZÃOSOCIAL AS FORNECEDOR, P.VALORDEVENDA-F.VALORDECOMPRA AS 'LUCRO POR PRODUTO',
(P.VALORDEVENDA-F.VALORDECOMPRA)*SUM(C.QUANTIDADEDEPRODUTO) AS 'LUCRO TOTAL DE PEDIDOS'
 FROM PRODUTO P
INNER JOIN (SELECT FO.RAZÃOSOCIAL,FO.IDFORNECEDOR,F.IDPRODUTO, F.VALORDECOMPRA FROM FORNECEDOR FO
INNER JOIN FORNECIMENTO F ON FO.IDFORNECEDOR=F.IDFORNECEDOR) F ON P.IDPRODUTO=F.IDPRODUTO
INNER JOIN CONTEM C ON P.IDPRODUTO=C.IDPRODUTO
GROUP BY P.IDPRODUTO
ORDER BY 4 DESC;

/*QUANTIDADE DE LUCRO EM CADA CATEGORIA*/
SELECT P.CATEGORIA, SUM(P.VALORDEVENDA-F.VALORDECOMPRA) AS 'LUCRO_POR_CATEGORIA',
(P.VALORDEVENDA-F.VALORDECOMPRA)*SUM(C.QUANTIDADEDEPRODUTO) AS 'LUCRO TOTAL DAS CATEGORIAS',
SUM(C.QUANTIDADEDEPRODUTO) AS 'QUANTIDADE DE VENDAS'
 FROM PRODUTO P
INNER JOIN FORNECIMENTO F ON P.IDPRODUTO=F.IDPRODUTO
INNER JOIN CONTEM C ON P.IDPRODUTO=C.IDPRODUTO
GROUP BY P.CATEGORIA
HAVING LUCRO_POR_CATEGORIA>200
ORDER BY 3 DESC;

/*QUANTIDADE DE PRODUTOS EM ESTOQUE*/
SELECT P.NOME, P.VALORDEVENDA,F.QUANTIDADEADQUIRIDA-C.QUANTIDADEDEPRODUTO+A.QUANTIDADE AS 
'QUANTIDADE DE PRODUTO DISPONIVEL',A.CIDADE,A.ESTADO FROM PRODUTO P
INNER JOIN FORNECIMENTO F ON P.IDPRODUTO=F.IDPRODUTO
INNER JOIN (SELECT SUM(QUANTIDADEDEPRODUTO) AS 'QUANTIDADEDEPRODUTO',IDPRODUTO FROM CONTEM
GROUP BY IDPRODUTO) C ON P.IDPRODUTO=C.IDPRODUTO
INNER JOIN (SELECT A.IDPRODUTO, A.QUANTIDADE,E.ESTADO,E.CIDADE FROM ARMAZENA A
INNER JOIN ESTOQUE E ON A.IDESTOQUE=E.IDESTOQUE) A ON P.IDPRODUTO=A.IDPRODUTO;


